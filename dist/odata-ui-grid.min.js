/**
 * odata-ui-grid - 0.0.2
 * odata uiGrid
 * 
 * 
 * Released under the MIT license.
 * Copyright 2016 Rodrigo Pimentel and contributors.
 */
var OdataUiGrid;!function(r){"use strict";var e=function(){function r(){}return r.main=angular.module("odata.ui.grid",["ODataResources","ui.grid","ui.grid.pagination"]),r}();r.Modules=e,e.main.run(["$templateCache",function(r){var e=r.get("ui-grid/uiGridHeaderCell").toString();e=e.replace(/ui\-grid\-filter/gi,"odata-ui-grid-filter"),r.put("ui-grid/uiGridHeaderCell",e)}])}(OdataUiGrid||(OdataUiGrid={}));var OdataUiGrid;!function(r){var e;!function(e){"use strict";var i=function(){function r(r,e,i,t,n,a){this.priority=-200,this.restrict="A",this.scope=!1,this.require="uiGrid",this.filterTermMappings={},this.paginationOptions={page:1,paginationPageSizes:[25,50,75],paginationPageSize:25,sort:""};var o=this;this.link=function(r,u,c,s){function d(){o.filterTermMappings[a.filter.STARTS_WITH]="startswith",o.filterTermMappings[a.filter.ENDS_WITH]="endswith",o.filterTermMappings[a.filter.EXACT]="eq",o.filterTermMappings[a.filter.CONTAINS]="contains",o.filterTermMappings[a.filter.GREATER_THAN]="gt",o.filterTermMappings[a.filter.GREATER_THAN_OR_EQUAL]="ge",o.filterTermMappings[a.filter.LESS_THAN]="lt",o.filterTermMappings[a.filter.LESS_THAN_OR_EQUAL]="le"}function p(){var e=r.$eval(c.odataUiGridQueryOptions),i=r.$eval(c.uiGrid);if(i){i.useExternalPagination=!0,i.useExternalFiltering=!0,i.useExternalSorting=!0;var t=i.onRegisterApi;i.onRegisterApi=function(n){t&&t(n),e.$currentQuery={gridApi:n,provider:e.resource.odata(),predicate:e.predicate,expand:e.expand,select:e.select,skip:e.skip,take:e.take,sort:e.sort,sortDirection:e.sortDirection},n.core.on.sortChanged(r,function(r,i){angular.noop(r),f(e)}),n.core.on.filterChanged(r,function(){f(e)}),n.pagination&&(i.currentPage=i.currentPage||o.paginationOptions.page,i.paginationPageSize=i.paginationPageSize||o.paginationOptions.paginationPageSize,i.paginationPageSizes=i.paginationPageSizes||o.paginationOptions.paginationPageSizes,n.pagination.on.paginationChanged(r,function(r,t){i.currentPage=r,i.paginationPageSize=t,f(e)})),e.preventInitialLoad||f(e)}}}function l(r){var i=r.$currentQuery.gridApi,t=i.grid.options;if(r.$currentQuery.skip=(t.currentPage-1)*t.paginationPageSize,r.$currentQuery.take=t.paginationPageSize,i&&t){var n=function(r){e(function(){void 0!==r&&void 0!==r.count&&(t.totalItems=r.count,i.grid.appScope[t.data]=r)})},a=function(){angular.noop()};y(r,o.filterTermMappings).then(n,a)}}function f(r){Q&&(e.cancel(Q),Q=null),Q=e(function(r){g(r),$(r),l(r)},r.debounceDelay,!0,r)}function g(r,e){if(!r||!r.resource)throw new Error("Need a valid odataUiGridQueryOptions object with a valid resource.");var i={gridApi:e||r.$currentQuery.gridApi,provider:r.resource.odata(),predicate:r.predicate,expand:r.expand,select:r.select,skip:r.skip,take:r.take,sort:r.sort,sortDirection:r.sortDirection};r.$currentQuery=i}function $(r){var e=r.$currentQuery.gridApi.grid.columns.filter(function(r){return Object.keys(r.sort).length});e.sort(function(r,e){return r.sort.priority===e.sort.priority?0:r.sort.priority>e.sort.priority?1:-1}).some(function(e,i){return r.$currentQuery.sort=e.field,r.$currentQuery.sortDirection=e.sort.direction,!0})}function v(r,e,i,n){if(i=i.replace(".","/"),-1!==["startswith","endswith"].indexOf(e))r.$currentQuery.provider=r.$currentQuery.provider.filter(new t.Func(e,new t.Property(i),new t.Value(n)),!0);else if("contains"===e)r.$currentQuery.provider=r.$currentQuery.provider.isv4?r.$currentQuery.provider.filter(new t.Func("contains",new t.Property(i),new t.Value(n))):r.$currentQuery.provider.filter(new t.Func("substringof",new t.Value(n),new t.Property(i)));else{n=isNaN(n)?n:parseInt(n,10);var a=new t.Predicate(i,e,n);r.$currentQuery.predicate=r.$currentQuery.predicate?r.$currentQuery.predicate.and(a):a}}function y(r,e){m&&m();var t=function(r){return void 0!==r.term&&null!==r.term&&""!==r.term.toString().trim()},n=r.$currentQuery.gridApi.grid;n.columns.filter(function(r){var e=!1;return n&&n.options&&n.options.enableFiltering&&(e=r&&r.filters&&r.filters.length&&r.filters.some(t)),e}).forEach(function(i){i.filters&&i.filters.forEach(function(n){n&&void 0!==e[n.condition]&&t(n)&&v(r,e[n.condition],i.field,n.term)})});var a=r.$currentQuery.provider;r.$currentQuery.predicate&&(a=a.filter(r.$currentQuery.predicate)),r.$currentQuery.select&&(a=a.select(r.$currentQuery.select)),r.$currentQuery.expand&&r.$currentQuery.expand.length&&r.$currentQuery.expand.forEach(function(r){a=a.expand(r)}),r.$currentQuery.skip&&(a=a.skip(r.$currentQuery.skip)),r.$currentQuery.take&&(a=a.take(r.$currentQuery.take)),r.$currentQuery.sort&&(a=a.orderBy(r.$currentQuery.sort,r.$currentQuery.sortDirection)),r.$currentQuery.provider=a;var o=i(function(r,e){m=function(){e(),m=null},a.withInlineCount().query(function(e){m=null,r(e)},function(){m=null,e()})});return o}angular.noop(r,u,c,n);var m,Q;d(),p()}}return r.$inject=["$compile","$timeout","$q","$odata","$odataresource","uiGridConstants"],r}();e.OdataUiGrid=i,r.Modules.main.directive("odataUiGrid",["$compile","$timeout","$q","$odata","$odataresource","uiGridConstants",function(r,e,t,n,a,o){return new i(r,e,t,n,a,o)}])}(e=r.Base||(r.Base={}))}(OdataUiGrid||(OdataUiGrid={}));var OdataUiGrid;!function(r){var e;!function(e){"use strict";var i=function(){function r(e,i,t){this.restrict="AE",this.scope=!1,this.compile=function(){return{pre:function(t,n,a){function o(){var e=!1;return t.col&&t.col.filters&&(e=t.col.filters.some(function(e){return-1!==r.customFiltersProvided.indexOf(e.type)})),e}angular.noop(a);var u=t.col.grid.options&&t.col.grid.options.useExternalFiltering&&o()?i.get("lib/directives/odataUiGridFilterView.html"):"<div ui-grid-filter></ui-grid-filter>";n.html(""),n.append(e(angular.element(u))(t))}}}}return r.customFiltersProvided=["date"],r.$inject=["$compile","$templateCache","uiGridConstants"],r}();e.OdataUiGridFilter=i,r.Modules.main.directive("odataUiGridFilter",["$compile","$templateCache","uiGridConstants",function(r,e,t){return new i(r,e,t)}])}(e=r.Base||(r.Base={}))}(OdataUiGrid||(OdataUiGrid={}));